import"./request-6OUf9ASD.js";/* empty css                   *//* empty css                     *//* empty css                     */import{a as O,b as A,e as W,f as X,h as Z,p as G}from"./exam-BwCz1nEL.js";import{b as J,_ as K}from"./question-2YlpUYkl.js";import{Z as V,e as E,r as y,c as p,a as o,t as ee,u as q,b as t,E as te,X as ae,w as i,O as le,U as oe,R as se,_ as ie,d as w,Q as x,o as r,l as m,V as ne,W as c,M as de,N as ue,S as me}from"./index-oXHeAlsD.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"add-exam-component-box"},ce={class:"add-exam-component"},fe={class:"exam-base-info-box"},_e={class:"exam-base-title"},xe={class:"base-title"},ve={class:"exam-base-info"},ye={class:"group-box"},be={class:"group-item"},ge={class:"group-box"},Ee={class:"group-item"},ke={class:"group-box"},Ce={class:"group-item"},Ie={class:"exam-select-question-box"},De={key:0,style:{color:"#3EC8FF"}},Se={key:1,style:{color:"#FE7909"}},Ve={key:2,style:{color:"#FD4C40"}},qe={class:"exam-list-box"},we={key:0,style:{color:"#3EC8FF"}},he={key:1,style:{color:"#FE7909"}},ze={key:2,style:{color:"#FD4C40"}},Fe={class:"exam-question-list-button"},Ne={class:"submit-box absolute"},Qe={__name:"UpdateExam",setup(Ue){const h=V().query.type,s=E({examId:"",title:"",examDate:""}),n=E({pageNum:1,pageSize:10,difficulty:"",title:""});function k(){w.go(-1)}async function z(){const a=new FormData;for(let e in s)e==="examDate"?(a.append("startTime",s.examDate[0]),a.append("endTime",s.examDate[1])):e!=="startTime"&&e!=="endTime"&&a.append(e,s[e]);if(s.examId)await X(a);else{const e=await Z(a);s.examId=e.data}x.success("基本信息保存成功")}const C=y([]),I=y(0);async function f(){const a=await J(n);console.log(a),C.value=a.rows,I.value=a.total}const v=y(!1);function F(){s.examId===null||s.examId===""?x.error("请先保存竞赛基本信息"):(f(),v.value=!0)}function N(){n.pageNum=1,f()}function Q(){f()}function U(){n.pageNum=1,f()}function T(){n.pageNum=1,n.pageSize=10,n.title="",n.difficulty="",f()}async function B(){await G(s.examId),w.push("/oj/layout/exam")}const _=y([]);function L(a){_.value=[],a.forEach(e=>{_.value.push(e.questionId)})}async function R(){if(_.value&&_.value.length<1)return x.error("请先选择要提交的题目"),!1;const a=E({examId:s.examId,questionIdSet:_.value});console.log(a),await W(a),b(s.examId),v.value=!1,x.success("竞赛题目添加成功")}async function M(){const a=V().query.examId;a&&(s.examId=a,b(a))}M();async function Y(a,e){await A(a,e),b(a),x.success("竞赛题目删除成功")}async function b(a){const e=await O(a);s.examQuestionList=[],Object.assign(s,e.data),s.examDate=[e.data.startTime,e.data.endTime]}return(a,e)=>{const D=te,j=ae,d=le,u=ne,S=se,g=ue,P=de,$=me,H=ie;return r(),p("div",re,[o("div",ce,[o("div",fe,[o("div",_e,[o("span",xe,ee(q(h)==="edit"?"编辑竞赛":"添加竞赛"),1),o("span",{class:"go-back",onClick:k},"返回")]),o("div",ve,[o("div",ye,[o("div",be,[e[8]||(e[8]=o("div",{class:"item-label required"},"竞赛名称",-1)),o("div",null,[t(D,{modelValue:s.title,"onUpdate:modelValue":e[0]||(e[0]=l=>s.title=l),style:{width:"420px"},placeholder:"请填写竞赛名称"},null,8,["modelValue"])])])]),o("div",ge,[o("div",Ee,[e[9]||(e[9]=o("div",{class:"item-label required"},"竞赛周期",-1)),o("div",null,[t(j,{modelValue:s.examDate,"onUpdate:modelValue":e[1]||(e[1]=l=>s.examDate=l),disabledDate:a.disabledDate,type:"datetimerange","start-placeholder":"竞赛开始时间","end-placeholder":"竞赛结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabledDate"])])])]),o("div",ke,[o("div",Ce,[t(d,{class:"exam-base-info-button",type:"primary",plain:"",onClick:z},{default:i(()=>e[10]||(e[10]=[m("保存",-1)])),_:1,__:[10]})])])])]),o("div",Ie,[t(d,{class:"exam-add-question",icon:q(oe),type:"text",onClick:e[2]||(e[2]=l=>F())},{default:i(()=>e[11]||(e[11]=[m(" 添加题目 ",-1)])),_:1,__:[11]},8,["icon"]),t(S,{height:"136px",data:s.examQuestionList,class:"question-select-list"},{default:i(()=>[t(u,{prop:"questionId",width:"180px",label:"题目id"}),t(u,{prop:"title","show-overflow-tooltip":!0,label:"题目标题"}),t(u,{prop:"difficulty",width:"80px",label:"题目难度"},{default:i(({row:l})=>[l.difficulty===1?(r(),p("div",De,"简单")):c("",!0),l.difficulty===2?(r(),p("div",Se,"中等")):c("",!0),l.difficulty===3?(r(),p("div",Ve,"困难")):c("",!0)]),_:1}),t(u,{label:"操作",width:"80px"},{default:i(({row:l})=>[t(d,{circle:"",type:"text",onClick:Te=>Y(s.examId,l.questionId)},{default:i(()=>e[12]||(e[12]=[m(" 删除 ",-1)])),_:2,__:[12]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),o("div",null,[t(H,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=l=>v.value=l)},{default:i(()=>[o("div",qe,[e[16]||(e[16]=o("div",{class:"exam-list-title required"},"选择竞赛题目",-1)),t(P,{inline:"true"},{default:i(()=>[t(g,{label:"题目难度"},{default:i(()=>[t(K,{modelValue:n.difficulty,"onUpdate:modelValue":e[3]||(e[3]=l=>n.difficulty=l),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),t(g,{label:"题目名称"},{default:i(()=>[t(D,{modelValue:n.title,"onUpdate:modelValue":e[4]||(e[4]=l=>n.title=l),placeholder:"请您输入要搜索的题目标题"},null,8,["modelValue"])]),_:1}),t(g,null,{default:i(()=>[t(d,{onClick:U,plain:""},{default:i(()=>e[13]||(e[13]=[m("搜索",-1)])),_:1,__:[13]}),t(d,{onClick:T,plain:"",type:"info"},{default:i(()=>e[14]||(e[14]=[m("重置",-1)])),_:1,__:[14]})]),_:1})]),_:1}),t(S,{data:C.value,onSelect:L},{default:i(()=>[t(u,{type:"selection"}),t(u,{prop:"questionId",label:"题目id"}),t(u,{prop:"title",label:"题目标题"}),t(u,{prop:"difficulty",label:"题目难度"},{default:i(({row:l})=>[l.difficulty===1?(r(),p("div",we,"简单")):c("",!0),l.difficulty===2?(r(),p("div",he,"中等")):c("",!0),l.difficulty===3?(r(),p("div",ze,"困难")):c("",!0)]),_:1})]),_:1},8,["data"]),o("div",Fe,[t($,{background:"",size:"small",layout:"total, sizes, prev, pager, next, jumper",total:I.value,"current-page":n.pageNum,"onUpdate:currentPage":e[5]||(e[5]=l=>n.pageNum=l),"page-size":n.pageSize,"onUpdate:pageSize":e[6]||(e[6]=l=>n.pageSize=l),"page-sizes":[1,5,10,15,20],onSizeChange:N,onCurrentChange:Q},null,8,["total","current-page","page-size"]),t(d,{class:"question-select-submit",type:"primary",plain:"",onClick:R},{default:i(()=>e[15]||(e[15]=[m("提交",-1)])),_:1,__:[15]})])])]),_:1},8,["modelValue"])]),o("div",Ne,[t(d,{type:"info",plain:"",onClick:k},{default:i(()=>e[17]||(e[17]=[m("取消",-1)])),_:1,__:[17]}),t(d,{type:"primary",plain:"",onClick:B},{default:i(()=>e[18]||(e[18]=[m("发布竞赛",-1)])),_:1,__:[18]})])])])}}},He=pe(Qe,[["__scopeId","data-v-f20b54bb"]]);export{He as default};
